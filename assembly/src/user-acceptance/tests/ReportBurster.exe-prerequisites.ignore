*** Settings ***
Library     SeleniumLibrary
Library     OperatingSystem
Library     resources/utilities.py
Variables   resources/vars.py
Test Setup    Clean State

*** Keywords ***
Open Electron Application
  [Documentation]  Open's your electron application by providing browser binary via
  ...  ${signal_electron} and chromedriver binary via ${signal_service}
  ...  see vars.py for more details.
  Create Webdriver    Chrome    options=${signal_electron}    service=${signal_service}

Close Electron Application
  [Documentation]  Kills the Electron application process
  Kill Reportburster Exe Process

Clean State
  [Documentation]  Clean Output Folders and Log Files
  Clean Output Folders and Log Files

#Capture Failed Test Screenshot
#  [Documentation]  Captures a screenshot with a name based on the test case name
#  Capture Page Screenshot    EMBED

*** Test Cases ***
Prerequisites Chocolatey Is Installed and Java Not Installed Should Allow User To Install Java
    [Documentation]  Prerequisites Chocolatey Is Installed and Java Not Installed Should Allow User To Install Java
    Ensure Chocolatey Is Installed
    Ensure Java Is Not Installed
    Open Electron Application
    Sleep  1s
    Wait Until Page Contains Element    id=btnInstallJavaTabBurst    timeout=30
    Sleep  1s
    Click Button    id=btnInstallJavaTabBurst
    Wait Until Page Contains Element    id=btnInstallJava    timeout=30
    Page Should Not Contain Element    id=btnInstallChocolatey
    Sleep  1s
    Click Button    id=btnInstallJava
    Wait Until Page Contains Element    css=.dburst-button-question-decline    timeout=30
    Sleep  1s
    Click Element    css=.dburst-button-question-decline
    Wait Until Element Is Not Visible    css=.dburst-button-question-decline    timeout=30
    Sleep  1s
    Click Button    id=btnInstallJava
    Wait Until Page Contains Element    css=.dburst-button-question-confirm    timeout=30
    Sleep  1s
    Click Element    css=.dburst-button-question-confirm
    Wait Until Element Is Not Visible    css=.dburst-button-question-confirm    timeout=30
    Sleep  1s
    Wait For Powershell And Accept Completion
    Close Electron Application
    Sleep  1s
    Open Electron Application
    Wait Until Page Contains Element    id=burstFile    timeout=30
    Sleep  1s
    Page Should Not Contain Element    id=btnInstallJavaTabBurst
    Sleep  1s
    Close Electron Application
    
Prerequisites Java 8 Installed Should Let The User Know That At Least Java 11 Is Required
    [Documentation]  Prerequisites Java 8 Installed Should Let The User Know That At Least Java 11 Is Required
    Ensure Chocolatey Is Installed
    Ensure Java Is Installed   version=8
    Open Electron Application
    Sleep  1s
    Wait Until Page Contains Element    id=javaInstallationOld    timeout=30
    Sleep  1s
    Close Electron Application
    
Prerequisites Chocolatey Not Installed and Java Not Installed Should Allow User to Install Chocolatey and Then Java
   [Documentation]  Chocolatey Not Installed and Java Not Installed Should Allow User to Install Chocolatey and Then Java
   Ensure Chocolatey Is Not Installed
   Ensure Java Is Not Installed
   Open Electron Application
   Sleep  1s
   Wait Until Page Contains Element    id=btnInstallJavaTabBurst    timeout=30
   Click Button    id=btnInstallJavaTabBurst
   Wait Until Page Contains Element    id=btnInstallChocolatey    timeout=30
   Element Should Be Enabled  id=btnInstallChocolatey
   Wait Until Page Contains Element    id=btnInstallJava    timeout=30
   Element Should Be Disabled   id=btnInstallJava

   Sleep  1s
   Click Button    id=btnInstallChocolatey
   Wait Until Page Contains Element    css=.dburst-button-question-decline    timeout=30
   Sleep  1s
   Click Element    css=.dburst-button-question-decline
   Wait Until Element Is Not Visible    css=.dburst-button-question-decline    timeout=30
   Sleep  1s
   Click Button    id=btnInstallChocolatey
   Wait Until Page Contains Element    css=.dburst-button-question-confirm    timeout=30
   Sleep  1s
   Click Element    css=.dburst-button-question-confirm
   Wait Until Element Is Not Visible    css=.dburst-button-question-confirm    timeout=30
   Sleep  100s
#   Wait For Powershell And Accept Completion
   Close Electron Application
    

# Prerequisites Chocolatey Installed But Choco Minus Version Not Working Should Work Fine
#   [Documentation] Chocolatey Installed But Choco Minus Version Not Working Should Work Fine