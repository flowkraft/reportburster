<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>ChapterÂ 2.Â Burst Excel Reports</title><link rel="stylesheet" href="css/skrf.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.74.0"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><script xmlns="" type="text/javascript" src="css/shCore.js"><!----></script><script xmlns="" type="text/javascript" src="css/shBrushJava.js"><!----></script><script xmlns="" type="text/javascript" src="css/shBrushGroovy.js"><!----></script><link xmlns="" href="css/shCore.css" rel="stylesheet" type="text/css"/><link xmlns="" href="css/shThemeDefault.css" rel="stylesheet" type="text/css"/><script xmlns="" type="text/javascript">
     SyntaxHighlighter.all()
</script><link rel="home" href="index.html" title="DocumentBurster User Guide"/><link rel="up" href="pt02.html" title="PartÂ II.Â  DocumentBurster"/><link rel="prev" href="chapter.pdf.html" title="ChapterÂ 1.Â Burst and Merge PDF Reports"/><link rel="next" href="chapter.distributing.html" title="ChapterÂ 3.Â Distribute Reports"/></head>
				<body>
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-K63768" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
				new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
				})(window,document,'script','dataLayer','GTM-K63768');</script>
			<ul class="docnav"><li class="previous"><a accesskey="p" href="chapter.pdf.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="chapter.distributing.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="chapter.excel"/>ChapterÂ 2.Â Burst Excel Reports</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="chapter.excel.html#chapter.excel.overview">2.1. Overview</a></span></dt><dt><span class="section"><a href="chapter.excel.html#chapter.excel.bursting.by.distinct.sheets">2.2. Burst by Distinct Sheets</a></span></dt><dt><span class="section"><a href="chapter.excel.html#chapter.excel.bursting.by.distinct.column.values">2.3. Burst by Distinct Column Values</a></span></dt><dd><dl><dt><span class="section"><a href="chapter.excel.html#d0e1400">2.3.1. How It Works</a></span></dt><dt><span class="section"><a href="chapter.excel.html#chapter.excel.bursting.steps">2.3.2. 
				Steps to Follow When Bursting an Excel Report by Distinct
				Column Values
			</a></span></dt><dt><span class="section"><a href="chapter.excel.html#chapter.excel.bursting.sample">2.3.3. 
				Sample -
				Customers-Distinct-Column-Values.xls
			</a></span></dt></dl></dd></dl></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="chapter.excel.overview"/>2.1.Â Overview</h2></div></div></div><p>
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			can burst and split reports which are generated for the following
			versions of
			Microsoft Excel
			spreadsheet application
			</p><div class="itemizedlist"><ul><li>Excel 2010 (version 14) included in Office 2010</li><li>Excel 2007 (version 12) included in Office 2007</li><li>Excel 2003 (version 11) included in Office 2003</li><li>Excel 2002 (version 10) included with Office XP</li><li>Excel 2000 (version 9.0) included with Office 2000
				</li><li>Excel 97 (version 8.0) included with Office 97</li></ul></div><p>
		</p><p>
			Although it does complex report processing,
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			doesn't require
			Microsoft Excel application to be installed on the
			machine where
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			is deployed. Even more, being a cross platform
			software,
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			can process Excel reports
			on a Windows or on any UNIX/Linux
			machine. A
			common installation scenario is to have
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			deployed on a
			separate
			dedicated server machine
			which is responsible for
			doing asynchronous batch report bursting and
			scheduled report
			distribution.
		</p><p>
			In order to achieve more business scenarios,
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			supports
			two different ways of bursting
			Excel reports
			</p><div class="itemizedlist"><ul><li>Burst by Distinct Sheets</li><li>Burst by Distinct Column Values</li></ul></div><p>
		</p><p>
			Depending on each specific business situation, one or the other
			of the
			two distinct
			bursting methods will be
			more appropriate. Following
			paragraphs will give details about each of
			the supported bursting
			methods.
		</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="chapter.excel.bursting.by.distinct.sheets"/>2.2.Â Burst by Distinct Sheets</h2></div></div></div><p>
			When bursting Excel reports using this method,
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			will generate a separate output file for
			each Excel sheet which is
			found in
			the input report.
		</p><p>
			The best way to describe this bursting method is by looking at
			<code class="filename">samples/Payslips-Distinct-Sheets.xls</code>
			sample report. This report is provided with
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			and contains monthly income data for three fictional employees. The
			data
			for each employee is found on a separate sheet and the name of
			the sheet is the employee's email
			address.
			</p><div class="mediaobject"><img src="images/burst-reports1.png"/></div><p>
			</p><div class="mediaobject"><img src="images/split-excel-sheets.png"/></div><p>
		</p><p>
			The input report has the following three distinct sheets
			<span class="emphasis"><em>cgrew@northridgehealth.org,</em></span>
			<span class="emphasis"><em>kbutford@northridgehealth.org</em></span>
			and
			<span class="emphasis"><em>awaldback@northridgehealth.org</em></span>
			which, after bursting, will generate the following three distinct
			files
			</p><div class="mediaobject"><img src="images/burst-excel-sheets.png"/></div><p>
		</p><p>
			Using email addresses as sheet names for the input
			report can
			help when
			distributing the generated
			output files by email (if the
			respective
			email addresses would
			actually be
			valid and existing email
			addresses).
			For more details
			about distributing the generated output
			reports
			by
			email please check
			<a class="xref" href="chapter.distributing.html" title="ChapterÂ 3.Â Distribute Reports">ChapterÂ 3, <i>Distribute Reports</i></a>
			.
		</p><p>
			This bursting method is straightforward and there is not much
			more to
			discuss about it. Following paragraph
			will present a more
			complex
			report bursting method which can
			generate a
			separate output file
			for
			each distinct value
			found in a specified column from a specified
			sheet.
		</p><div class="note"><h2>Note</h2><p>
				By default,
				<span class="emphasis"><em>
					<span class="trademark">DocumentBurster</span>â„¢
				</em></span>
				will burst Excel reports by
				distinct sheets and the names of the
				sheets will be used as burst tokens.
			</p></div><div class="note"><h2>Note</h2><p>
				Beside payslips,
				<span class="emphasis"><em>
					<span class="trademark">DocumentBurster</span>â„¢
				</em></span>
				can be configured to break up and distribute any other Excel report
				types such
				as
				invoices, statements,
				purchase orders, commissions
				reports or
				dunning
				letters.
			</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="chapter.excel.bursting.by.distinct.column.values"/>2.3.Â Burst by Distinct Column Values</h2></div></div></div><p>
			When bursting Excel reports using this method,
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			will generate a
			separate output file for
			each distinct value
			found in a
			specified column from a specified sheet.
		</p><p>
			Please check the existing sample report
			<code class="filename">samples/Customers-Distinct-Column-Values.xls</code>
			which can
			be found in
			<code class="filename">samples</code>
			folder.
			<code class="filename">Customers-Distinct-Column-Values.xls</code>
			report contains a list of customers from various
			countries
			which, after
			bursting,
			<span class="emphasis"><em>
				<span class="trademark">DocumentBurster</span>â„¢
			</em></span>
			will generate a
			separate file with each file containing
			the customers
			for
			the
			relevant country.
			</p><div class="mediaobject"><img src="images/burst-reports1.png"/></div><p>
			</p><div class="mediaobject"><img src="images/split-excel-report.png"/></div><p>
			</p><p>
				Each configured
				<span class="emphasis"><em>burst token</em></span>
				will generate a different output file.
			</p><p>
			</p><div class="mediaobject"><img src="images/burst-excel.png"/></div><p>
		</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1400"/>2.3.1.Â How It Works</h3></div></div></div><p>
				The
				<span class="emphasis"><em>last sheet</em></span>
				of the input report
				<code class="filename">samples/Customers-Distinct-Column-Values.xls</code>
				is called
				<span class="emphasis"><em>
					burst
				</em></span>
				and
				contains the metadata required for bursting the
				report.
			</p><div class="important"><h2>
					Important -
					
						burst
					
					Sheet
				</h2><p>
					In order to burst by distinct column values

					it is mandatory that
					the
					<span class="emphasis"><em>last sheet</em></span>
					of the input report
					will
					be called
					<span class="emphasis"><em>
						burst
					</em></span>

					and this sheet should contain the proper (meta)information
					required
					for
					bursting the
					report.
				</p><p>
					If
					<span class="emphasis"><em>
						<span class="trademark">DocumentBurster</span>â„¢
					</em></span>
					doesn't find the last sheet
					to have the name
					<span class="emphasis"><em>burst</em></span>
					then it will fallback to process
					the report by using the previous
					alternative
					bursting method described in
					<a class="xref" href="chapter.excel.html#chapter.excel.bursting.by.distinct.sheets" title="2.2.Â Burst by Distinct Sheets">SectionÂ 2.2, â€œBurst by Distinct Sheetsâ€?</a>
					.
				</p></div><div class="important"><h2>Important - Replace All Excel Formulas With the Corresponding
					Calculated Values
				</h2><p>
					In order to burst by distinct column values all
					the
					formulas (if the
					report contains formulas) should be pre-calculated
					before
					the report
					is sent for processing to
					<span class="emphasis"><em>
						<span class="trademark">DocumentBurster</span>â„¢
						.
					</em></span>
				</p><p>
					<a class="ulink" href="http://office.microsoft.com/en-us/excel-help/replace-a-formula-with-its-result-HP010066258.aspx">

						Microsoft Excel documentation - Replace a formula with
						its
						result


					</a>
				</p></div><p>
				Following screenshot shows how the
				(meta)information
				<span class="emphasis"><em>
					burst
				</em></span>
				sheet should look.
				</p><div class="mediaobject"><img src="images/excel-burst-metadata.png"/></div><p>
			</p><p>
				<span class="emphasis"><em>(*)burstMethod :
					(distinct-sheets|distinct-column-values)
				</em></span>
				- Required information which specifies the
				bursting method to be
				used.
				Following two valid values are possible
				</p><div class="itemizedlist"><ul><li><span class="emphasis"><em>distinct-column-values</em></span>
						â€“ should be used when splitting the report by the distinct values
						found in a
						column
					</li><li><span class="emphasis"><em>distinct-sheets</em></span>
						â€“ should be used when splitting the input report by each distinct
						sheet
					</li></ul></div><p>
			</p><p>
				Default value is
				<span class="emphasis"><em>distinct-column-values.</em></span>
			</p><p>
				<span class="emphasis"><em>(*)burstMethod</em></span>
				is an information which is mandatory to be provided.
			</p><p>
				<span class="emphasis"><em>burstSheetIndex</em></span>
				- 0 (zero) based index of the sheet which needs to be split. For
				example, if it is required to split the first sheet then the index
				should be 0, if second sheet should be split then the index should
				be
				1 and so on.
			</p><p>
				-1 is an allowed conventional value which means to
				split
				the
				first
				sheet
				of the Excel report.
			</p><p>
				Default value is -1.
			</p><p>
				<span class="emphasis"><em>burstColumnIndex</em></span>
				- 0 (zero) based index of the column to be used when splitting the
				report.
				If it is required to split using the first column
				then
				<span class="emphasis"><em>burstColumnIndex</em></span>
				should be defined as 0, if second column is required for splitting
				then
				<span class="emphasis"><em>burstColumnIndex</em></span>
				should be defined as 1 and so on.
			</p><p>
				Usually the splitting column will be
				the last column from the
				splitting sheet.
				-1 is an allowed conventional value which means to
				split using the last column from the splitting sheet.
			</p><p>
				Default value is -1.
			</p><p>
				<span class="emphasis"><em>(*)burstTokens</em></span>
				- required information which specifies the list of distinct burst
				tokens for which
				<span class="emphasis"><em>
					<span class="trademark">DocumentBurster</span>â„¢
				</em></span>
				should generate a separate output file. For example, in the above
				screenshot the
				list
				of burst tokens contains
				the set of distinct
				countries for which
				<span class="emphasis"><em>
					<span class="trademark">DocumentBurster</span>â„¢
				</em></span>
				should generate
				an output file.
			</p><p>
				<span class="emphasis"><em>(*)burstTokens</em></span>
				is
				an information which is mandatory to be provided.
			</p><p>
				<span class="emphasis"><em>userVariables</em></span>
				- information to be provided in case there is a need to specify
				custom user variables for
				each distinct burst token. For more details
				on how to define user
				variables when bursting Excel reports please
				read
				<a class="xref" href="chapter.variables.html" title="ChapterÂ 5.Â Variables">ChapterÂ 5, <i>Variables</i></a>
				.
			</p><p>
				<span class="emphasis"><em>configFile</em></span>
				- information to be provided in case there is a need to process
				distinct Excel report types by using
				a different set of program
				configurations. By default, if no custom
				<span class="emphasis"><em>configFile</em></span>
				is
				provided,
				<span class="emphasis"><em>
					<span class="trademark">DocumentBurster</span>â„¢
				</em></span>
				is processing all Excel reports using the default configuration
				file
				<code class="filename">./config/burst/settings.xml.</code>
				This should be fine in most situations,
				however there are cases when
				different reports will require different sets
				of configurations.
				For
				more details
				about how
				to process Excel
				reports
				using a custom
				configuration file
				please
				read
				<a class="xref" href="chapter.templates.html#chapter.templates.excel" title="4.2.Â Process Excel Reports Using a Custom Configuration File">SectionÂ 4.2, â€œProcess Excel Reports Using a Custom
			Configuration File
		â€?</a>
				.
			</p><p>
				Next screenshot shows how the report
				<code class="filename">samples/Customers-Distinct-Column-Values.xls</code>
				was configured in order to be processed by
				<span class="emphasis"><em>
					<span class="trademark">DocumentBurster</span>â„¢
					.
				</em></span>
				For reasons of better visualization, the last column
				which is only
				used in this sample report for the purpose of report
				bursting, it is
				highlighted
				with the yellow color. It is not mandatory
				that the
				bursting
				column should have a specific color. Usually
				the burst column
				will be a hidden Excel
				column which will not
				be
				visible
				to the normal
				report users but
				only defined for the purpose of
				bursting the report.
			</p><p>
				(1) -
				<span class="emphasis"><em>
					<span class="trademark">DocumentBurster</span>â„¢
				</em></span>
				will keep the "empty rows"
				in the output reports. This is useful for
				keeping in the output files
				various headers and/or footers which a
				report might have.
				</p><div class="mediaobject"><img src="images/break-excel-report.png"/></div><p>
				(2) -
				Last column contains the values from which
				<span class="emphasis"><em>
					<span class="trademark">DocumentBurster</span>â„¢
				</em></span>
				will decide which Excel row goes to which
				output file. It can have
				any color and will usually be a hidden
				Excel column.
			</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1592"/>2.3.1.1.Â 
					<span class="emphasis"><em>Copy Report Header/Footer
					</em></span>
				</h4></div></div></div><p>
					In real life most Excel reports will have a header and/or
					a
					footer
					(e.g. the company name/logo, the name of
					the report etc.)
					which
					is
					statically defined
					and which should be copied
					<span class="emphasis"><em>ad litteram</em></span>
					to each of the output files.
				</p><p>
					</p><div class="mediaobject"><img src="images/excel-report-header.png"/></div><p>
				</p><p>
					<span class="emphasis"><em>(1)</em></span>
					-
					<span class="emphasis"><em>
						<span class="trademark">DocumentBurster</span>â„¢
					</em></span>
					keeps the
					<span class="emphasis"><em>â€?empty rowsâ€?</em></span>
					in the output reports. This is used to copy
					the static report
					headers or footers (and any other static
					row) to the output reports.
				</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="chapter.excel.bursting.steps"/>2.3.2.Â 
				Steps to Follow When Bursting an Excel Report by Distinct
				Column Values
			</h3></div></div></div><p>Following general steps should be followed when bursting an
				Excel
				report by distinct
				column values.
			</p><div class="procedure"><a id="d0e1628"/><p class="title"><b>ProcedureÂ 2.1.Â 
					Steps to Follow When Bursting an Excel Report by Distinct
					Column Values
				</b></p><ol class="1"><li><p>
						Identify the appropriate
						<span class="emphasis"><em>burst token</em></span>
						for the type of report which is being burst.
						A
						<span class="emphasis"><em>burst token</em></span>
						can be anything which
						is uniquely identifying the document to be
						extracted such as the
						invoice ID, customer number or the email
						address where the document should be distributed.
					</p></li><li><p>
						Configure and prepare the input Excel report to include the
						(meta)information (the
						<span class="emphasis"><em>burst</em></span>
						sheet)
						required for bursting the document.
					</p></li><li><p>
						This step is required only if the report contains Excel
						formulas.
						Before the report is sent for processing to
						<span class="emphasis"><em>
							<span class="trademark">DocumentBurster</span>â„¢
						</em></span>
						all
						the formulas should be pre-calculated and replaced with the
						corresponding
						values.
					</p><p>
						See
						<a class="ulink" href="http://office.microsoft.com/en-us/excel-help/replace-a-formula-with-its-result-HP010066258.aspx">
							Microsoft Excel documentation - Replace a formula
							with
							its
							result
						</a>
						for more details.
					</p></li><li><p>Burst the report and check the output files.
					</p></li></ol></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="chapter.excel.bursting.sample"/>2.3.3.Â 
				Sample -
				<code class="filename">Customers-Distinct-Column-Values.xls</code>
			</h3></div></div></div><p>
				The previous steps will be exemplified when bursting the same
				<code class="filename">samples/Customers-Distinct-Column-Values.xls.</code>
			</p><div class="procedure"><ol class="1"><li><p>
						Identify the appropriate
						<span class="emphasis"><em>burst token.</em></span>
					</p><p>
						The report to be burst contains a list of customers
						and
						each
						customer has a country of origin. The requirement
						is to
						break the
						report by country and each output file should
						contain the
						customers
						from the relevant country.
					</p><p>
						The
						<span class="emphasis"><em>burst token</em></span>
						is identified as being the
						<span class="emphasis"><em>Country</em></span>
						column.
					</p></li><li><p>Configure and prepare the input Excel report to include the
						(meta)information
						required for bursting the document.
					</p><p>
						In order to burst by distinct column values
						it is mandatory that
						the
						<span class="emphasis"><em>last sheet</em></span>
						of the input report
						will
						be called
						<span class="emphasis"><em>
							burst
						</em></span>
						and this sheet should contain the proper (meta)information
						required
						for
						bursting the
						report.
					</p><p>
						</p><div class="mediaobject"><img src="images/excel-metadata-explained.png"/></div><p>
					</p><p>
						The last column from the splitting sheet is yellow (for
						better
						visualization) and is added only for the purpose of bursting
						the
						report. The bursting column doesn't need to have a specific
						color
						and will usually be an invisible Excel column (so that the
						normal
						report user will not see it).
					</p><p>
						</p><div class="mediaobject"><img src="images/split-excel.png"/></div><p>
					</p><p>
						(1) - Extra column which is added for the purpose of
						splitting
						the report.
						It can be defined as a hidden Excel column so
						that it
						will be invisible to the
						normal report users.
					</p></li><li><p>
						Calculate and replace Excel formulas with the corresponding
						values
					</p><p>
						<code class="filename">Customers-Distinct-Column-Values.xls</code>
						sample report doesn't
						contain any Excel formula, so there is
						nothing
						to do for this report in regards with that.
					</p></li><li><p>
						Burst the report and check the output files.
					</p><p>
						Burst
						<code class="filename">samples/Customers-Distinct-Column-Values.xls</code>
						report and
						check the list of output files, one Excel file for each
						country
						with
						each output file containing the list of customers from
						the
						specific country.
					</p></li></ol></div></div></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="chapter.pdf.html"><strong>Prev</strong>ChapterÂ 1.Â Burst and Merge PDF Reports</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="chapter.distributing.html"><strong>Next</strong>ChapterÂ 3.Â Distribute Reports</a></li></ul>
				<script type="text/javascript">
				window.$zopim||(function(d,s){var z=$zopim=function(c){z._.push(c)},$=z.s= d.createElement(s),e=d.getElementsByTagName(s)[0];z.set=function(o){z.set. _.push(o)};z._=[];z.set._=[];$.async=!0;$.setAttribute('charset','utf-8'); $.src='//cdn.zopim.com/?h7mkkauOUJAVdDuy4BEr4FLv2scL9q1J';z.t=+new Date;$. type='text/javascript';e.parentNode.insertBefore($,e)})(document,'script');
				</script>
</body>
			</html>