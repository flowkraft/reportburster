<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Customer Sales Summary</title>
  <style type="text/css">
    /* Basic Excel-friendly styles (all inline supported by ReportBurster Excel exporter) */
    body { font-family: Arial, Helvetica, sans-serif; font-size:11pt; color:#111111; }
    h1 { font-size:14pt; margin:6px 0 12px 0; color:#0b57a4; }
    .company { font-weight:bold; font-size:12pt; color:#0b57a4; }
    .meta { font-size:10pt; color:#333333; margin-bottom:8px; }
    table { border-collapse:collapse; width:100%; }
    thead th {
      background-color:#0b57a4;
      color:#ffffff;
      font-weight:bold;
      padding:6px 8px;
      text-align:left;
      border: 1px solid #cccccc;
    }
    tbody td {
      padding:6px 8px;
      border: 1px solid #e0e0e0;
      vertical-align:middle;
    }
    tfoot td {
      padding:8px;
      border-top:2px solid #0b57a4;
      font-weight:bold;
      background-color:#f2f9ff;
    }
    .numeric { text-align:right; }
    .small { font-size:9pt; color:#666666; }
    .note { margin-top:10px; font-size:9pt; color:#666666; }
    /* ensure long text wraps in Excel */
    td, th { white-space:normal; word-wrap:break-word; }
  </style>
</head>
<body>

  <div class="company">[[PUT_YOUR_COMPANY_NAME_HERE]]</div>
  <div class="meta">Customer Sales Summary â€” Top customers by sales (single query)</div>
  <div class="meta small">Report generated: ${now?string("yyyy-MM-dd HH:mm:ss")}</div>

  <!--
    FreeMarker template: expects reportData as a List<Map> where each row map exposes:
      CustomerID, CompanyName, OrdersCount, TotalSales, AvgOrderValue
    The SQL that feeds this template should provide exactly those columns.
  -->

  <!-- Single worksheet named "Customer Sales Summary" -->
  <table data-sheet-name="Customer Sales Summary" role="presentation">
    <thead>
      <tr>
        <!-- Freeze panes at header row / first column by marking first header cell -->
        <th data-freeze-pane-cell="true">Customer ID</th>
        <th>Company Name</th>
        <th class="numeric">Orders</th>
        <th class="numeric">Total Sales (USD)</th>
        <th class="numeric">Avg Order Value (USD)</th>
      </tr>
    </thead>

    <tbody>
      <#if reportData?size == 0>
        <tr>
          <td data-text-cell="true" colspan="5">No data available for the selected period.</td>
        </tr>
      <#else>
        <#-- iterate over rows returned by the SQL datasource -->
        <#list reportData as row>
          <tr>
            <!-- Force CustomerID as text to preserve leading zeros -->
            <td data-text-cell="true">${row.CustomerID?html}</td>

            <!-- Company name as text (default) -->
            <td>${row.CompanyName?html}</td>

            <!-- OrdersCount numeric (integer) -->
            <td class="numeric" data-numeric-cell-format="##0">${row.OrdersCount?string["0"]}</td>

            <!-- TotalSales numeric, add to named group for grand total calculation -->
            <td class="numeric"
                data-numeric-cell-format="#,##0.00"
                data-group="total_sales">
              ${row.TotalSales?string["0.00"]}
            </td>

            <!-- AvgOrderValue numeric -->
            <td class="numeric" data-numeric-cell-format="#,##0.00">
              ${row.AvgOrderValue?string["0.00"]}
            </td>
          </tr>
        </#list>
      </#if>
    </tbody>

    <tfoot>
      <tr>
        <td colspan="2">Top customers shown: ${reportData?size?string["0"]}</td>
        <td class="numeric"> </td>
        <!-- Grand total for TotalSales computed from data-group="total_sales" above -->
        <td class="numeric" data-group-output="total_sales" data-numeric-cell-format="#,##0.00">0</td>
        <td class="numeric"> </td>
      </tr>
    </tfoot>
  </table>

  <div class="note">
    Notes:
    <ul>
      <li>This file is generated from a single SQL query against the packaged Northwind database (last 12 months by default).</li>
      <li>Currency formatting uses numeric cell formats; adjust your reporting configuration if you need other currencies.</li>
      <li>You can change the SQL date filter in the sample configuration to adjust the reporting period.</li>
    </ul>
  </div>

</body>
</html>