services:
  postgres:
    image: postgres:16.2
    container_name: rb-northwind-postgresql
    environment:
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      POSTGRES_DB: ${POSTGRES_DB}
    ports:
      - "${POSTGRES_PORT}:5432"
    volumes:
      - ${DATA_ROOT_DIR}/sample-northwind-postgresql:/var/lib/postgresql/data
      - ${LOG_ROOT_DIR}-postgresql:/var/log/postgresql
    restart: unless-stopped

  mysql:
    image: mysql:8.3.0
    container_name: rb-northwind-mysql
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_PASSWORD}
      MYSQL_DATABASE: ${MYSQL_DB}
      MYSQL_ROOT_HOST: '%'
    ports:
      - "${MYSQL_PORT}:3306"
    volumes:
      - ${DATA_ROOT_DIR}/sample-northwind-mysql:/var/lib/mysql
      - ${LOG_ROOT_DIR}-mysql:/var/log/mysql
    command: --general-log=1 --general-log-file=/var/log/mysql/mysql-general.log
    restart: unless-stopped

  mariadb:
    image: mariadb:11.3.2
    container_name: rb-northwind-mariadb
    environment:
      MARIADB_ROOT_PASSWORD: ${MARIADB_PASSWORD}
      MARIADB_DATABASE: ${MARIADB_DB}
      MARIADB_ROOT_HOST: '%'
    ports:
      - "${MARIADB_PORT}:3306"  # Using 3307 to avoid conflict with MySQL
    volumes:
      - ${DATA_ROOT_DIR}/sample-northwind-mariadb:/var/lib/mysql
      - ${LOG_ROOT_DIR}-mariadb:/var/log/mysql
    command: --general-log=1 --general-log-file=/var/log/mysql/mariadb-general.log
    restart: unless-stopped

  sqlserver:
    image: mcr.microsoft.com/mssql/server:2022-latest
    container_name: rb-northwind-sqlserver
    environment:
      ACCEPT_EULA: Y
      MSSQL_SA_PASSWORD: ${SQLSERVER_PASSWORD}
      MSSQL_PID: Developer
    ports:
      - "${SQLSERVER_PORT}:1433"
    volumes:
      - ${DATA_ROOT_DIR}/sample-northwind-sqlserver:/var/opt/mssql
      - ${LOG_ROOT_DIR}-sqlserver:/var/opt/mssql/log
    restart: unless-stopped

  oracle:
    image: gvenzl/oracle-xe:21-slim-faststart
    container_name: rb-northwind-oracle
    environment:
      ORACLE_PASSWORD: ${ORACLE_PASSWORD}
      ORACLE_DATABASE: XE
      ORACLE_CHARACTERSET: AL32UTF8
    ports:
      - "${ORACLE_PORT}:1521"
    volumes:
      - ${DATA_ROOT_DIR}/sample-northwind-oracle:/opt/oracle/oradata
      - ${LOG_ROOT_DIR}-oracle:/opt/oracle/diag/rdbms
    restart: unless-stopped
    command: --databaseConfigurationType=SMALL

  db2:
    image: icr.io/db2_community/db2:12.1.0
    container_name: rb-northwind-db2
    privileged: true
    environment:
      LICENSE: accept
      DB2INST1_PASSWORD: ${DB2_PASSWORD}
      DBNAME: ${DB2_DB}
      PERSISTENT_HOME: "true"
      ARCHIVE_LOGS: "true"
    ports:
      - "${DB2_PORT}:50000"
    volumes:
      - ${DATA_ROOT_DIR}/sample-northwind-db2:/database
      - ${LOG_ROOT_DIR}-db2:/database/db2dump
    restart: unless-stopped  